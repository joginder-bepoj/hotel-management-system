<section class="content">
  <div class="content-block">
    <div class="block-header mt-n3">
      <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
          <ul class="breadcrumb breadcrumb-style">
            <li class="breadcrumb-item">
              <h4 class="wlcm-text">Welcome to {{activeHotel?.hotel_name || 'HMS Dashboard'}}!</h4>
            </li>
          </ul>
        </div>
      </div>
    </div>
    
    <!-- Row 1: Key Metrics -->
    <div class="row">
      <div class="col-lg-3 col-md-6 col-sm-12">
        <div class="card info-box-5 bg-blue">
          <div class="card-icon">
            <mat-icon>login</mat-icon>
          </div>
          <div class="card-content">
            <div class="text">Today's Check-ins</div>
            <div class="number">{{checkInsToday}}</div>
          </div>
        </div>
      </div>
      <div class="col-lg-3 col-md-6 col-sm-12">
        <div class="card info-box-5 bg-orange">
          <div class="card-icon">
            <mat-icon>logout</mat-icon>
          </div>
          <div class="card-content">
            <div class="text">Today's Check-outs</div>
            <div class="number">{{checkOutsToday}}</div>
          </div>
        </div>
      </div>
      <div class="col-lg-3 col-md-6 col-sm-12">
        <div class="card info-box-5 bg-green">
          <div class="card-icon">
            <mat-icon>monetization_on</mat-icon>
          </div>
          <div class="card-content">
            <div class="text">Today's Revenue</div>
            <div class="number">${{totalRevenueToday | number}}</div>
          </div>
        </div>
      </div>
      <div class="col-lg-3 col-md-6 col-sm-12">
        <div class="card info-box-5 bg-red">
          <div class="card-icon">
            <mat-icon>pending_actions</mat-icon>
          </div>
          <div class="card-content">
            <div class="text">Pending Payments</div>
            <div class="number">${{pendingPayments | number}}</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Row 2: Charts -->
    <div class="row clearfix">
      <!-- Revenue Summary Chart -->
      <div class="col-xl-8 col-lg-8 col-md-12 col-sm-12">
        <div class="card">
          <div class="header">
            <h2>Revenue Summary</h2>
          </div>
          <div class="body">
            <apx-chart
              [series]="revenueChartOptions.series || []"
              [chart]="revenueChartOptions.chart!"
              [xaxis]="revenueChartOptions.xaxis!"
              [stroke]="revenueChartOptions.stroke!"
              [tooltip]="revenueChartOptions.tooltip!"
              [dataLabels]="revenueChartOptions.dataLabels!"
              [colors]="revenueChartOptions.colors!"
            >
            </apx-chart>
          </div>
        </div>
      </div>
      
      <!-- Occupancy Chart -->
      <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12">
        <div class="card">
          <div class="header">
            <h2>Current Occupancy</h2>
          </div>
          <div class="body">
            <apx-chart
              [series]="occupancyChartOptions.series || []"
              [chart]="occupancyChartOptions.chart!"
              [plotOptions]="occupancyChartOptions.plotOptions!"
              [labels]="occupancyChartOptions.labels!"
              [colors]="occupancyChartOptions.colors!"
            >
            </apx-chart>
            <div class="text-center mt-3">
              <p class="text-muted">Total Rooms: {{totalRooms}}</p>
              <p class="text-success">Occupied: {{occupiedRooms}}</p>
              <p class="text-primary">Available: {{availableRooms}}</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Row 3: Operational Status -->
    <div class="row clearfix">
      
      <!-- Room Availability Snapshot -->
      <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12">
        <div class="card">
          <div class="header">
            <h2>Room Availability Snapshot</h2>
          </div>
          <div class="body">
            <div class="mb-4" *ngFor="let room of roomAvailability">
              <div class="d-flex justify-content-between mb-1">
                <span class="font-weight-600">{{room.type}}</span>
                <span class="badge" [ngClass]="'badge-solid-' + room.color">{{room.percentage}}%</span>
              </div>
              <div class="progress skill-progress w-100">
                <div role="progressbar" 
                     [attr.aria-valuenow]="room.percentage" 
                     aria-valuemin="0" 
                     aria-valuemax="100" 
                     [style.width.%]="room.percentage"
                     [ngClass]="'l-bg-' + room.color"
                     class="progress-bar">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Housekeeping Status -->
      <div class="col-xl-4 col-lg-4 col-md-6 col-sm-12">
        <div class="card">
          <div class="header">
            <h2>Housekeeping Status</h2>
          </div>
          <div class="body">
            <ul class="list-unstyled user-progress list-unstyled-border list-unstyled-noborder">
              <li class="media" *ngFor="let item of housekeepingStatus">
                <div class="media-body">
                  <div class="media-title">Room {{item.room}}</div>
                  <div class="text-job text-muted">{{item.staff}}</div>
                </div>
                <div class="media-progressbar">
                  <div class="progress-text">{{item.status}}</div>
                </div>
                <div class="media-cta">
                  <span class="badge" 
                        [class.bg-orange]="item.status === 'Cleaning'"
                        [class.bg-blue]="item.status === 'Inspection'"
                        [class.bg-red]="item.status === 'Dirty'"
                        [class.bg-green]="item.status === 'Clean'">
                    {{item.status}}
                  </span>
                </div>
              </li>
            </ul>
             <div class="text-center pt-3">
              <a href="#" class="btn btn-primary">View All</a>
            </div>
          </div>
        </div>
      </div>

      <!-- Alerts & Notifications -->
      <div class="col-xl-4 col-lg-4 col-md-6 col-sm-12">
        <div class="card">
          <div class="header">
            <h2>Alerts & Notifications</h2>
          </div>
          <div class="body">
            <div class="recent-activity">
              <div class="activity-item" *ngFor="let alert of alerts">
                <div class="activity-icon" 
                     [class.bg-orange]="alert.type === 'warning'" 
                     [class.bg-blue]="alert.type === 'info'" 
                     [class.bg-red]="alert.type === 'error'">
                  <mat-icon *ngIf="alert.type === 'warning'">warning</mat-icon>
                  <mat-icon *ngIf="alert.type === 'info'">info</mat-icon>
                  <mat-icon *ngIf="alert.type === 'error'">error</mat-icon>
                </div>
                <div class="activity-content">
                  <p class="mb-0">{{alert.message}}</p>
                  <span class="text-muted small">{{alert.time}}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>

    <!-- Recent Booking Table -->
    <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <div class="card">
                <div class="header">
                    <h2>Recent Bookings</h2>
                </div>
                <div class="body table-responsive tableBody">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Name</th>
                                <th>Phone</th>
                                <th>Check-In</th>
                                <th>Check-Out</th>
                                <th>Room Type</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let b of dataSource; let i = index">
                                <td>
                                    <img class="table-img" src="https://www.einfosoft.com/templates/admin/spiceangular/source/light/assets/images/user/user{{(i % 5) + 1}}.jpg" alt="user" width="35">
                                </td>
                                <td>{{b.name}}</td>
                                <td>{{b.phone}}</td>
                                <td>{{b.checkIn}}</td>
                                <td>{{b.checkOut}}</td>
                                <td>{{b.roomType}}</td>
                                <td>
                                    <span class="badge" 
                                          [class.bg-green]="b.status === 'Paid'" 
                                          [class.bg-red]="b.status === 'Unpaid'"
                                          [class.bg-orange]="b.status === 'Pending'">
                                        {{b.status}}
                                    </span>
                                </td>
                                <td>
                                    <button mat-icon-button class="tbl-action-btn btn-tbl-edit">
                                        <mat-icon>edit</mat-icon>
                                    </button>
                                    <button mat-icon-button class="tbl-action-btn btn-tbl-delete">
                                        <mat-icon>delete</mat-icon>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
  </div>
</section>
